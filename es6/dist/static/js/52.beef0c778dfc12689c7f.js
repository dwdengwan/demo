webpackJsonp([52],{YmNV:function(e,t,a){var n=a("vPhR");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);a("po5z")("0321e71e",n,!0)},hadM:function(e,t,a){"use strict";function n(e){a("YmNV")}Object.defineProperty(t,"__esModule",{value:!0});var i=a("rYnR"),o=a("Fd2+"),s={components:{myHeader:i.default},props:["mapNeedData","leakAddress"],data:function(){var e=this;return{title:"报修地点",zoom:16,center:[121.52014,31.198862],searchOption:{city:"深圳市",citylimit:!0},marker:{position:[121.52014,31.198862]},address:"",lng:0,lat:0,events:{click:function(t){var a=t.lnglat,n=a.lng,i=a.lat;e.lng=n,e.lat=i,e.marker.position=[n,i],new AMap.Geocoder({radius:1e3,extensions:"all"}).getAddress([n,i],function(t,a){"complete"===t&&"OK"===a.info&&a&&a.regeocode&&(e.address=a.regeocode.formattedAddress,e.$nextTick())})}},plugin:[{pName:"Geolocation",events:{init:function(t){t.getCurrentPosition(function(t,a){if(a&&a.position){e.lng=a.position.lng,e.lat=a.position.lat,e.center=[e.lng,e.lat],e.marker.position=[e.lng,e.lat];new AMap.Geocoder({radius:1e3,extensions:"all"}).getAddress([e.lng,e.lat],function(t,a){"complete"===t&&"OK"===a.info&&a&&a.regeocode&&(e.address=a.regeocode.formattedAddress,e.$nextTick())}),e.$nextTick()}})}}}]}},mounted:function(){this.initConfigMes(),$(".myMap .search-box .search-box-wrapper input").attr("placeholder","查找地点");$(".myMap .search-box .search-box-wrapper input").before('<img src="../../../static/img/fangdajing.png" alt="" height="22px" style="margin-left:2%">')},methods:{getUserMes:function(){this.searchOption={city:this.mapNeedData.province,citylimit:!0},this.title=this.mapNeedData.province,this.$nextTick()},onSearchResult:function(e){console.log(e);var t=this,a=e[0].lng,n=e[0].lat;this.center=[a,n],this.marker.position=[a,n],new AMap.Geocoder({radius:1e3,extensions:"all"}).getAddress([a,n],function(e,a){"complete"===e&&"OK"===a.info&&a&&a.regeocode&&(t.address=a.regeocode.formattedAddress,t.$nextTick())})},initConfigMes:function(){var e=this;this.title=this.mapNeedData.province;var t={data:{url:window.location.href}};this.$api.fetch({params:t,apiUrl:"/public/wxConfigMes"}).then(function(t){e.wxData=t,e.wx.config({appId:t.appId,timestamp:t.timestamp,nonceStr:t.nonceStr,signature:t.signature,jsApiList:["getLocation"]}),e.wx.ready(function(t){e.wx.getLocation({type:"gcj02",success:function(t){var a=t.latitude,n=t.longitude;t.speed,t.accuracy;e.lng=n,e.lat=a,e.center=[n,a],e.marker.position=[n,a],(new AMap.Geocoder).getAddress([n,a],function(t,a){"complete"===t&&"OK"===a.info&&a&&a.regeocode&&(e.address=a.regeocode.formattedAddress,e.$nextTick())}),e.$nextTick()},fail:function(e){}})})})},onClickLeft:function(){this.backChange(0)},onClickRight:function(){if(""==this.address){if("repair"==this.mapNeedData.content)return void o.d.fail("报障地点不能为空");if("leak"==this.mapNeedData.content)return void o.d.fail("报漏地点不能为空")}this.backChange(1)},backChange:function(e){var t={};0==e?t.address=this.leakAddress:1==e&&(t.address=this.address),this.BUS.$emit("getAddress",t.address,this.mapNeedData.content),this.$parent.leakandrepairsShow=!0,this.$parent.repairMapShow=!1}}},r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"myMap"},[a("page-content",[a("van-nav-bar",{attrs:{title:e.title,"left-text":"返回","right-text":"确定","left-arrow":""},on:{"click-left":e.onClickLeft,"click-right":e.onClickRight}}),e._v(" "),a("div",{staticClass:"map_content"},[a("div",{staticClass:"amap-page-container"},[a("el-amap-search-box",{staticClass:"search-box",attrs:{"search-option":e.searchOption,"on-search-result":e.onSearchResult},on:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.onSearchResult(t)}}}),e._v(" "),a("el-amap",{staticClass:"amap-demo",attrs:{vid:"amapDemo",plugin:e.plugin,center:e.center,zoom:e.zoom,events:e.events}},[a("el-amap-marker",{attrs:{position:e.marker.position,events:e.marker.events,visible:e.marker.visible,draggable:e.marker.draggable}})],1),e._v(" "),a("van-field",{staticClass:"kron-field",attrs:{label:"报修地址：",rows:"3",autosize:"",type:"textarea",value:e.address,placeholder:"请选择报修地址",readonly:""}})],1)])],1)],1)},c=[],d={render:r,staticRenderFns:c},l=d,p=a("VU/8"),h=n,m=p(s,l,!1,h,"data-v-7fd38e98",null);t.default=m.exports},vPhR:function(e,t,a){t=e.exports=a("FZ+f")(void 0),t.push([e.i,".myMap .el-vue-search-box-container .search-tips[data-v-7fd38e98]{border:none}.myMap .map_content[data-v-7fd38e98]{height:93%;margin:0}.myMap .map_content .amap-page-container[data-v-7fd38e98]{height:86%}.myMap .map_content .amap-page-container .search-box[data-v-7fd38e98]{width:90%;height:46px;line-height:46px;position:absolute;top:55px;left:5%}.myMap .map_content .amap-page-container .kron-field[data-v-7fd38e98]{height:18%}",""])}});
//# sourceMappingURL=52.beef0c778dfc12689c7f.js.map