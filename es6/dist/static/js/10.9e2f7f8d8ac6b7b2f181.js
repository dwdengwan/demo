webpackJsonp([10,52],{"9fNB":function(a,e,t){e=a.exports=t("FZ+f")(void 0),e.push([a.i,'.leak-and-repairs .yh-my-uploader[data-v-460d5782]{padding:10px 2%;border-bottom:1px solid #eee}.leak-and-repairs .yh-my-uploader .uploader-content[data-v-460d5782]{border:1px dashed #a6a7a8;height:80px;width:80px;color:#a6a7a8;border-radius:4px;text-align:center;padding-top:10px;position:relative;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%)}.leak-and-repairs .yh-my-uploader .uploader-content .van-icon[data-v-460d5782]{font-size:34px;color:#a6a7a8}.leak-and-repairs .yh-my-uploader .uploader-content .uploader-length[data-v-460d5782]{font-size:16px}.leak-and-repairs .van-radio-group[data-v-460d5782]{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;width:100%;border-bottom:1px solid #eee}.leak-and-repairs .van-radio-group .van-radio[data-v-460d5782]{width:20%!important;padding:2% 0}.leak-and-repairs .van-cell--required[data-v-460d5782]:before{position:absolute;left:2px;color:#ee0a24;font-size:14px;content:"*"}.leak-and-repairs .span_content[data-v-460d5782]{padding:2% 2% 0}.leak-and-repairs .span_content .add-pic[data-v-460d5782]{border:0!important;font-size:16px;color:#323233;padding:10px 2%!important}.leak-and-repairs .span_content .van-radio-group[data-v-460d5782]{width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;padding:1%}.leak-and-repairs .span_content .van-radio-group .van-radio[data-v-460d5782]{width:33%}.leak-and-repairs .van-cell--large[data-v-460d5782]{border-bottom:1px solid #eee!important;padding:10px 2%!important}.leak-and-repairs .van-icon-location[data-v-460d5782]{font-size:20px}.leak-and-repairs .next[data-v-460d5782]{font-size:1rem;border-radius:5px;width:90%;margin:3% 3% 3% 5%;height:2.5rem;line-height:2.5rem}.leak-and-repairs .van-cell[data-v-460d5782]{border-bottom:1px solid #eee;padding:0}.leak-and-repairs .beizhu .van-cell[data-v-460d5782]{border-bottom:none;padding:0}.leak-and-repairs .tab-container .tabs .tab .col-100[data-v-460d5782]{width:99%;margin-left:2%}.leak-and-repairs .bottom_content[data-v-460d5782]{margin:0}.leak-and-repairs .bottom_content .col-100[data-v-460d5782]{margin-left:2%}.leak-and-repairs .bottom_content .list[data-v-460d5782]{margin:.5rem .5rem 1rem 0;-webkit-box-shadow:1px 1px 10px 1px #888;box-shadow:1px 1px 10px 1px #888}.leak-and-repairs .bottom_content .list ul[data-v-460d5782]{padding:10px 10px 0 0}.leak-and-repairs .bottom_content .list .item-content[data-v-460d5782]{padding:0}.leak-and-repairs .bottom_content .list li[data-v-460d5782]{border-bottom:0}.leak-and-repairs .bottom_content .list .item-inner[data-v-460d5782]{padding:10px 0 0!important}.leak-and-repairs .bottom_content .col-100[data-v-460d5782]{width:98%}.leak-and-repairs .bottom_content .button[data-v-460d5782]{background-color:#fff;color:#b6b6b6;font-size:1.3rem}.leak-and-repairs .item-title-row[data-v-460d5782]{margin-bottom:1%}.leak-and-repairs .first_content[data-v-460d5782]{display:inline-block;width:45%;border-bottom:1px solid #dcdcdc;padding-left:.75rem}.leak-and-repairs .first_content span[data-v-460d5782]{font-size:12px;color:#989898;font-weight:600}.leak-and-repairs .first_content input[data-v-460d5782]{width:90%;font-size:15px;border:none;font-weight:300}.leak-and-repairs .list li+li .item-content[data-v-460d5782]:before{background-color:#fff}.leak-and-repairs .second_content[data-v-460d5782]{display:inline-block;width:35%;border-bottom:1px solid #dcdcdc;padding-left:.75rem}.leak-and-repairs .second_content span[data-v-460d5782]{font-size:12px;color:#adadad;font-weight:600}.leak-and-repairs .second_content input[data-v-460d5782]{width:90%;font-size:15px;border:none;font-weight:300}.leak-and-repairs .second_content[data-v-460d5782]:first-child{width:25%}.leak-and-repairs .Third_content[data-v-460d5782]{display:inline-block;width:100%;border-bottom:1px solid #dcdcdc;padding-left:.75rem}.leak-and-repairs .Third_content span[data-v-460d5782]{font-size:12px;color:#888;font-weight:600}.leak-and-repairs .Third_content input[data-v-460d5782]{width:90%;font-size:15px;border:none;font-weight:300}.leak-and-repairs .kr-complain[data-v-460d5782]{margin-top:10px;padding:10px 20px;font-size:15px;-webkit-box-shadow:1px 1px 5px 1px #888;box-shadow:1px 1px 5px 1px #888}.leak-and-repairs .kr-complain .kr-div[data-v-460d5782]{display:-webkit-box;display:-ms-flexbox;display:flex;width:100%}.leak-and-repairs .kr-complain .kr-div div[data-v-460d5782]{width:100%}.leak-and-repairs .kr-complain .kr-div div span[data-v-460d5782]{font-weight:600;color:#989898;font-size:12px}.leak-and-repairs .kr-complain .kr-div div input[data-v-460d5782]{color:#000;border:0;width:100%;border-bottom:1px solid #888;border-radius:0}.leak-and-repairs .kr-complain .kr-div .kr-div-last[data-v-460d5782]{margin-left:5%}.leak-and-repairs .kr-complain .kr-div-third[data-v-460d5782]{display:-webkit-box;display:-ms-flexbox;display:flex;width:100%}.leak-and-repairs .kr-complain .kr-div-third div[data-v-460d5782]{width:30%}.leak-and-repairs .kr-complain .kr-div-third div span[data-v-460d5782]{font-weight:600;color:#989898;font-size:12px}.leak-and-repairs .kr-complain .kr-div-third div input[data-v-460d5782]{color:#000;border:0;width:100%;border-bottom:1px solid #888;border-radius:0}.leak-and-repairs .kr-complain .kr-div-third .kr-div-last .van-radio-group[data-v-460d5782]{width:100%;display:-webkit-box;display:-ms-flexbox;display:flex}.leak-and-repairs .kr-complain .kr-div-third .kr-div-last .van-radio-group .van-radio[data-v-460d5782]{width:100%}.leak-and-repairs .kr-complain .kr-div-third .kr-radio[data-v-460d5782]{width:100%;padding:2% 0}.leak-and-repairs .kr-complain .kr-div-third .kr-radio span[data-v-460d5782]{padding:1% 0;font-weight:600;color:#989898;font-size:12px}.leak-and-repairs .kr-complain .kr-title p[data-v-460d5782]{font-weight:600;color:#989898;font-size:12px}.leak-and-repairs .kr-complain .kr-title input[data-v-460d5782],.leak-and-repairs .kr-complain .kr-title textarea[data-v-460d5782]{color:#000;border:0;width:100%;border-bottom:1px solid #888;border-radius:0}.leak-and-repairs .kr-complain .kr-title .kr-div-last .van-radio-group[data-v-460d5782]{width:100%;display:-webkit-box;display:-ms-flexbox;display:flex}.leak-and-repairs .kr-complain .kr-title .kr-div-last .van-radio-group .van-radio[data-v-460d5782]{width:100%}.leak-and-repairs .kr-complain .kr-title .kr-div-last .van-radio-group .van-radio .van-radio__label[data-v-460d5782]{padding:1% 0;font-weight:600;color:#989898;font-size:12px}.leak-and-repairs .kr-complain .kr-title .kr-radio[data-v-460d5782]{padding:2% 0}.leak-and-repairs .kr-complain .kr-title .kr-radio span[data-v-460d5782]{padding:1% 0;font-weight:600;color:#989898;font-size:12px}.leak-and-repairs .add_box[data-v-460d5782]{position:absolute;width:20%;right:4%;height:8%}.leak-and-repairs .add_box .midle-bar[data-v-460d5782]{float:right}.leak-and-repairs .add_box1[data-v-460d5782]{top:61.5%}.leak-and-repairs .add_box2[data-v-460d5782]{top:66.5%}.leak-and-repairs .list[data-v-460d5782]{margin:0}.leak-and-repairs .list .list-title[data-v-460d5782]{padding:0}.leak-and-repairs .form-list .item-content img[data-v-460d5782]{position:absolute;top:.2rem;left:50%}.leak-and-repairs .yh-content[data-v-460d5782]{height:96%;overflow-y:auto}.leak-and-repairs .yh-content .yh-parent[data-v-460d5782]{border-radius:10px;-webkit-box-shadow:1px 1px 5px 1px #888;box-shadow:1px 1px 5px 1px #888;margin:2%;padding:10px 12px;font-size:15px;font-weight:300;border-bottom:1px solid #989898}.leak-and-repairs .yh-content .yh-parent .yh-bottom[data-v-460d5782],.leak-and-repairs .yh-content .yh-parent .yh-middle[data-v-460d5782],.leak-and-repairs .yh-content .yh-parent .yh-top[data-v-460d5782]{padding:6px 0}.leak-and-repairs .yh-content .yh-parent .yh-bottom .returnBtn[data-v-460d5782],.leak-and-repairs .yh-content .yh-parent .yh-middle .returnBtn[data-v-460d5782],.leak-and-repairs .yh-content .yh-parent .yh-top .returnBtn[data-v-460d5782]{-webkit-box-flex:1;-ms-flex:1;flex:1;height:1.6rem;line-height:1.6rem;border-radius:15px}.leak-and-repairs .yh-content .yh-parent .yh-top .yh-status[data-v-460d5782]{float:right;color:#489eff}.leak-and-repairs .yh-nodata[data-v-460d5782]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;height:100%}.leak-and-repairs .yh-nodata span[data-v-460d5782]{font-size:1rem;color:#bbb}.leak-and-repairs .box[data-v-460d5782]{width:100px;height:100px;background-color:#ed702d;color:#fff;transform:rotate(45deg);-ms-transform:rotate(45deg);-moz-transform:rotate(45deg);-webkit-transform:rotate(45deg);-o-transform:rotate(45deg);position:absolute;right:-50px;top:-50px}.leak-and-repairs .box .text[data-v-460d5782]{position:absolute;bottom:0}',""])},SbAm:function(a,e,t){var i=t("9fNB");"string"==typeof i&&(i=[[a.i,i,""]]),i.locals&&(a.exports=i.locals);t("po5z")("404427e9",i,!0)},YmNV:function(a,e,t){var i=t("vPhR");"string"==typeof i&&(i=[[a.i,i,""]]),i.locals&&(a.exports=i.locals);t("po5z")("0321e71e",i,!0)},dxoT:function(a,e,t){"use strict";function i(a){t("SbAm")}Object.defineProperty(e,"__esModule",{value:!0});var r=t("bOdI"),o=t.n(r),n=t("rYnR"),s=t("Gs2z"),l=t("hadM"),d=t("mtWM"),p=t.n(d),c=t("Fd2+"),u={components:{myHeader:n.default,headerThree:s.a,myMap:l.default},data:function(){return{message:{title:"报修/报漏",span1:"尊敬的"+localStorage.getItem("nickname"),span2:"请您仔细填写报修/报漏信息",span3:"我们将尽快处理并给予反馈",isShow:""},isLoading:!1,scrollTop:0,loading:!1,finished:!1,leakAddress:"",title:"报修/报漏",tabIndex:0,index:"",repairData:{faultEquipmentType:"",repairRemark:"",leakAddress:"",groupCode:"",userNo:"",groupName:""},repairFileList:[],leakData:{repairRemark:"",leakAddress:"",repairOrLeakDate:"",groupName:""},leakFileList:[],historyData:[],waterData:[],waterShow:!1,waterColumns:["梧州水司","梅州水司","儋州水司"],leakEquipmentData:[],leakEquipmentShow:!1,leakEquipmentColumns:[],equipmentData:[],equipmentShow:!1,equipmentColumns:[],timeShow:!1,currDate:new Date,leakandrepairsShow:!0,repairMapShow:!1,addressFor:"",province:"",upLoadNeedData:[],fileList:[],ftoken:"",fileUrlList:[],submitIndex:0,userNumData:[],userNumColumns:[],userNumShow:!1,mapNeedData:{},relationShow:!1,showAddress:!1,areaNum:"01013",areaList:{},emailURL:""}},mounted:function(){var a=this;this.BUS.$on("getAddress",function(e,t){"repair"==t?(a.repairData.leakAddress=e,a.leakAddress=e,a.tabIndex=0,a.$refs.tab.onClick(0)):"leak"==t&&(a.leakData.leakAddress=e,a.leakAddress=e,a.tabIndex=1,a.$refs.tab.onClick(1))})},created:function(){var a=this;document.body.addEventListener("focusout",function(){window.scrollTo({top:0,left:0,behavior:"smooth"})}),this.emailURL=URLurl,this.BUS.$on("fileList",function(e,t){a.fileList=e,"repair"==t?a.submitIndex=1:"leak"==t&&(a.submitIndex=2),a.getFtoken()}),null===localStorage.getItem("leakandrepairsHistory")?(this.getArrList2(),this.getEquipment(),localStorage.setItem("leakandrepairsHistory",!1)):"true"==localStorage.getItem("leakandrepairsHistory")?(this.getHistoryData(),this.getArrList2(),this.getEquipment(),this.tabIndex=1,this.$refs.tab.onClick(1),localStorage.setItem("leakandrepairsHistory",!1)):"false"==localStorage.getItem("leakandrepairsHistory")&&(this.getArrList2(),this.getEquipment(),this.tabIndex=0,this.$refs.tab.onClick(0))},destroyed:function(){},methods:{blur:function(a,e){var t="";if(""===a){switch(e){case"leakAddress":t="发生地点不能为空";break;case"repairRemark":t="备注信息不能为空";break;case"contact":t="联系人不能为空";break;case"phone":t="联系电话不能为空"}Object(c.d)(t)}else"phone"!=e||/^1[3456789]\d{9}$/.test(this.repairData.phone)||(t="联系电话有误!",Object(c.d)(t))},onLoad:function(a){var e=this;setTimeout(function(){e.loading=!1,e.historyData.length&&(e.finished=!0)},500)},scroll:function(a){parseInt(a.target.clientHeight)+Math.ceil(a.target.scrollTop)===parseInt(a.target.scrollHeight)||0==a.target.scrollTop&&a.stopPropagation(),this.$set(this,"scrollTop",a.target.scrollTop)},touchmove:function(a){0!==this.scrollTop&&a.stopPropagation()},onRefresh:function(){var a=this;setTimeout(function(){a.$toast("刷新成功"),a.isLoading=!1,a.emailURL=URLurl,a.BUS.$on("fileList",function(e,t){a.fileList=e,"repair"==t?a.submitIndex=1:"leak"==t&&(a.submitIndex=2),a.getFtoken()}),null===localStorage.getItem("leakandrepairsHistory")?(a.getArrList2(),a.getEquipment(),localStorage.setItem("leakandrepairsHistory",!1)):"true"==localStorage.getItem("leakandrepairsHistory")?(a.tabIndex=1,a.$refs.tab.onClick(1),a.getHistoryData(),a.getArrList2(),a.getEquipment(),localStorage.setItem("leakandrepairsHistory",!1)):"false"==localStorage.getItem("leakandrepairsHistory")&&(a.tabIndex=0,a.$refs.tab.onClick(0),a.getArrList2(),a.getEquipment()),a.BUS.$on("getAddress",function(e,t){"repair"==t?(a.repairData.leakAddress=e,a.leakAddress=e,a.tabIndex=0,a.$refs.tab.onClick(0)):"leak"==t&&(a.leakData.leakAddress=e,a.leakAddress=e,a.tabIndex=1)})},500)},openUserNumData:function(){this.userNumShow=!0,""==this.repairData.groupCode?this.getUserNum(""):this.getUserNum(this.repairData.groupCode)},getUserNum:function(a){var e=this,t={data:{openId:localStorage.getItem("openId"),groupCode:a}};e.$api.fetch({params:t,apiUrl:"/myWater/selfUserList"}).then(function(a){e.userNumData=[],e.userNumData=a,e.userNumColumns=e.userNumData.map(function(a){return a.userNo})})},selectRelation:function(){this.userNumShow=!0},onCancelRelation:function(){this.userNumShow=!1},onConfirmRelation:function(a,e){this.repairData.userNo=a;for(var t=0;t<this.userNumData.length;t++)this.userNumData[t].userNo==this.repairData.userNo&&(this.repairData.groupName=this.userNumData[t].groupArea,this.repairData.groupCode=this.userNumData[t].groupCode);for(var i in this.areaList.county_list){var r=i.slice(4);if(this.repairData.groupCode==r)this.areaNum=i;else for(var o in this.areaList.city_list){var n=o.slice(2);this.repairData.groupCode==n&&(this.areaNum=o)}}this.userNumShow=!1},moduleAccess:function(a,e){var t={data:{groupCode:a,openId:localStorage.getItem("openId"),moduleId:e}};this.$api.fetch({params:t,apiUrl:"/common/moduleVisitAdd"}).then(function(a){})},goUpload:function(a){this.upLoadNeedData.type=a,this.fileUrlList=[]},goMap:function(a){return"repair"==a&&""==this.repairData.groupName?void Object(c.d)("请先选择所属地区"):"leak"==a&&""==this.leakData.groupName?void Object(c.d)("请先选择所属地区"):(this.leakandrepairsShow=!1,this.repairMapShow=!0,this.mapNeedData.content=a,void(this.mapNeedData.province=this.province))},getFtoken:function(a){var e=this,t={data:{}};this.$api.fetch({params:t,apiUrl:"/myWater/getFtoken"}).then(function(t){if(e.ftoken=t.ftoken,1==a){if(0==e.repairFileList.length)return void e.submit(1);for(var i=0;i<e.repairFileList.length;i++)e.getImgUrl(e.repairFileList[i].file,a,i)}else if(2==a){if(0==e.leakFileList.length)return void e.submit(2);for(var r=0;r<e.leakFileList.length;r++)e.getImgUrl(e.leakFileList[r].file,a,r)}})},getImgUrl:function(a,e,t){var i=this,r=new FormData;r.append("file",a),r.append("ftoken",this.ftoken);var o={url:i.emailURL,method:"post",timeout:6e4,headers:{"Content-Type":"application/json"},withCredentials:!0,data:r};p()(o).then(function(a){200===a.status&&0===a.data.code&&(i.fileUrlList[t]=a.data.data.path,1==e?i.fileUrlList.length==i.repairFileList.length&&i.submit(e):2==e&&i.fileUrlList.length==i.leakFileList.length&&i.submit(e))},function(a){}).catch(function(a){})},formatter:function(a,e){return"year"===a?e+"年":"month"===a?e+"月":"day"===a?e+"日":e},clickTime:function(){this.timeShow=!this.timeShow},confirmTime:function(a){this.timeShow=!1;var e=a,t=e.getMonth()+1,i=e.getDate();t>=1&&t<=9&&(t="0"+t),i>=0&&i<=9&&(i="0"+i),this.leakData.repairOrLeakDate=e.getFullYear()+"-"+t+"-"+i},cancelTime:function(){this.timeShow=!1},getWater:function(){var a=this,e={data:{}};this.$api.fetch({params:e,apiUrl:"/common/wCompanyList"}).then(function(e){a.waterData=[],a.waterData=e,a.waterColumns=a.waterData.map(function(a){return a.groupFullName}),a.getEquipment(),a.getLeakEquipment()})},openWater:function(a){this.index=a,this.waterShow=!0},getEquipment:function(){var a=this,e={data:["equipment"]};this.$api.fetch({params:e,apiUrl:"/common/dictDownList"}).then(function(e){a.equipmentData=[],a.equipmentData=e.equipment,a.equipmentColumns=a.equipmentData.map(function(a){return a.name})})},openEquipment:function(){this.equipmentShow=!0},onCancelWater:function(){this.waterShow=!1},onConfirmWater:function(a,e){if(1==this.index){this.repairData.groupFullName=a;for(var t=0;t<this.waterData.length;t++)if(a==this.waterData[t].groupFullName){this.repairData.groupCode=this.waterData[t].groupCode;break}}else if(2==this.index){this.leakData.groupFullName=a;for(var i=0;i<this.waterData.length;i++)if(a==this.waterData[i].groupFullName){this.leakData.groupCode=this.waterData[i].groupCode;break}}this.waterShow=!1},onCancelEquipment:function(){this.equipmentShow=!1},onConfirmEquipment:function(a,e){this.repairData.faultEquipmentTypeName=a;for(var t=0;t<this.equipmentData.length;t++)if(a==this.equipmentData[t].name){this.repairData.faultEquipmentType=this.equipmentData[t].value;break}this.equipmentShow=!1},getHistoryData:function(){var a=this,e={data:{openId:localStorage.getItem("openId")}};this.$api.fetch({params:e,apiUrl:"/moreFun/repLeakList"}).then(function(e){a.historyData=e})},submit:function(a){for(var e=this,t=0;t<e.fileUrlList.length;t++)if(void 0===e.fileUrlList[t])return;console.log(this.repairData.faultEquipmentType);var i={};if(1==a){var r;i=this.repairData;var n={data:(r={openId:localStorage.getItem("openId"),groupCode:i.groupCode,userNo:i.userNo,contact:i.contact,phone:i.phone},o()(r,"contact",i.contact),o()(r,"faultEquipmentType",i.faultEquipmentType),o()(r,"leakAddress",i.leakAddress),o()(r,"repairRemark",i.repairRemark),o()(r,"repairOrLeak",a),o()(r,"picture",e.fileUrlList),r)}}else if(2==a){var s;i=this.leakData;var n={data:(s={openId:localStorage.getItem("openId"),groupCode:i.groupCode,repairOrLeakDate:i.repairOrLeakDate,faultEquipmentType:i.faultEquipmentType,contact:i.contact,phone:i.phone},o()(s,"contact",i.contact),o()(s,"leakAddress",i.leakAddress),o()(s,"repairRemark",i.repairRemark),o()(s,"repairOrLeak",a),o()(s,"picture",e.fileUrlList),s)}}this.$api.fetch({params:n,apiUrl:"/moreFun/repLeakAdd"}).then(function(t){1==a?c.d.success("报修成功，我们工作人员会尽快处理"):2==a&&c.d.success("报漏成功，我们工作人员会尽快处理"),setTimeout(function(){1==a?e.moduleAccess(e.repairData.groupCode,"9"):2==a&&e.moduleAccess(e.leakData.groupCode,"10"),e.repairData={},e.repairData.repairRemark="",e.leakData={},e.leakData.repairRemark="",e.fileUrlList=[],e.repairFileList=[],e.leakFileList=[],e.tabIndex=1,e.$refs.tab.onClick(1),e.getHistoryData()},2e3)}).catch(function(a){})},goLeakandrepairsDetail:function(a){var e={};e.groupCode=a.groupCode,e.id=a.id,e.status=a.status,e.repairOrLeakDate=a.repairOrLeakDate,e.repairOrLeak=a.repairOrLeak,this.$router.push({path:"/leakandrepairsDetail",query:e})},showAddressChuang:function(a){this.addressFor=a,this.relationShow=!0},sure:function(a){void 0===a[2]||""==a[2].code?"repair"==this.addressFor?(this.repairData.groupCode=a[1].code.slice(2),this.repairData.groupName=a[0].name+a[1].name,this.repairData.groupName=this.repairData.groupName.replace("*",""),this.getUserNum(this.repairData.groupCode)):"leak"==this.addressFor&&(this.leakData.groupCode=a[1].code.slice(2),this.leakData.groupName=a[0].name+a[1].name,this.leakData.groupName=this.leakData.groupName.replace("*","")):"repair"==this.addressFor?(this.repairData.groupCode=a[2].code.slice(4),this.repairData.groupName=a[0].name+a[1].name+a[2].name,this.repairData.groupName=this.repairData.groupName.replace("*",""),this.getUserNum(this.repairData.groupCode)):"leak"==this.addressFor&&(this.leakData.groupCode=a[2].code.slice(4),this.leakData.groupName=a[0].name+a[1].name+a[2].name,this.leakData.groupName=this.leakData.groupName.replace("*","")),this.province=a[1].name,this.repairData.userNo="",this.relationShow=!1},exit:function(){this.relationShow=!1},onChange:function(){},getArrList2:function(){var a=this,e={data:{openId:localStorage.getItem("openId")}};a.$api.fetch({params:e,apiUrl:"/common/wAreaTree"}).then(function(e){a.areaList.province_list=e.provinceMap,a.areaList.city_list=e.cityMap,a.areaList.county_list=e.areaMap,a.getBindData()})},getBindData:function(){var a=this,e=this,t={data:{}};e.$api.fetch({params:t,apiUrl:"/common/getUserInfo"}).then(function(t){var i=t.bwcList;if(console.log(i),i.length>0){e.repairData.groupCode=i[0].groupCode,e.repairData.groupName=i[0].groupName,e.repairData.phone=i[0].mobile,e.repairData.contact=i[0].contact,e.getUserNum(a.repairData.groupCode),e.province=i[0].provice;var r=e.repairData.groupCode,o=e.areaList.county_list,n=e.areaList.city_list,s=e.areaNum;e.areaNum=e.common.companyTree(r,o,n,s)}else e.getGeolocation()})},getSpaceNum:function(a,e){var t=this,i={data:{longitude:a,latitude:e}};t.$api.fetch({params:i,apiUrl:"/common/getShortestComp"}).then(function(a){t.$set(t.repairData,"groupCode",a.groupCode),t.$set(t.repairData,"groupName",a.groupArea),t.getUserNum(t.repairData.groupCode),t.province=bindData[0].provice})},getGeolocation:function(){var a=this,e=new AMap.Map("container",{resizeEnable:!0});AMap.plugin("AMap.Geolocation",function(){var t=new AMap.Geolocation({enableHighAccuracy:!0,timeout:1e4,buttonPosition:"RB",buttonOffset:new AMap.Pixel(10,20),zoomToAccuracy:!0});e.addControl(t),t.getCurrentPosition(function(e,t){"complete"==e&&a.getSpaceNum(t.position.lng,t.position.lat)})})},getLeakEquipment:function(){var a=this,e={data:["leak"]};this.$api.fetch({params:e,apiUrl:"/common/dictDownList"}).then(function(e){a.leakEquipmentData=[],a.leakEquipmentData=e.leak,a.leakEquipmentColumns=a.leakEquipmentData.map(function(a){return a.name})})},openLeakEquipment:function(){this.leakEquipmentShow=!0},onCancelLeakEquipment:function(){this.leakEquipmentShow=!1},onConfirmLeakEquipment:function(a,e){this.leakData.faultEquipmentTypeName=a;for(var t=0;t<this.leakEquipmentData.length;t++)if(a==this.leakEquipmentData[t].name){this.leakData.faultEquipmentType=this.leakEquipmentData[t].value;break}this.leakEquipmentShow=!1},reCall:function(a,e){var t=this,i=this;a.stopPropagation(),c.b.confirm({title:"是否确认撤回？"}).then(function(){var a={data:{groupCode:e.groupCode,id:e.id}};t.$api.fetch({params:a,apiUrl:"/moreFun/workOrderReCall"}).then(function(a){c.d.success({message:"撤回成功！",position:"middle",duration:2e3}),setTimeout(function(){i.getHistoryData(),i.getArrList2(),i.getEquipment()},2e3)})}).catch(function(){})},tabClick:function(a){var e=this;this.$nextTick(function(){"报修/报漏"==$("#yh-tab .active").html()?e.getEquipment():"报漏"==$("#yh-tab .active").html()?e.getLeakEquipment():"进度查询"==$("#yh-tab .active").html()&&e.getHistoryData()})},tabItemClick:function(a){a.stopPropagation()},test:function(a){}}},m=function(){var a=this,e=a.$createElement,t=a._self._c||e;return a.leakandrepairsShow?t("div",{staticClass:"leak-and-repairs"},[t("page-content",[t("headerThree",{attrs:{message:a.message}}),a._v(" "),t("tab",{ref:"tab",attrs:{active:a.tabIndex,id:"yh-tab"},nativeOn:{click:function(e){a.tabClick(a.tabIndex)}}},[t("tab-item",{attrs:{title:"报修/报漏"},nativeOn:{click:function(e){a.tabItemClick(e)}}},[t("div",{staticClass:"span_content"},[t("van-field",{staticClass:"yh-my-blue",attrs:{readonly:"",required:"","left-icon":"location-o","right-icon":"arrow",label:"所属地区",placeholder:"请选择地区",size:"large"},on:{click:function(e){a.showAddressChuang("repair")}},model:{value:a.repairData.groupName,callback:function(e){a.$set(a.repairData,"groupName",e)},expression:"repairData.groupName"}}),a._v(" "),t("van-field",{staticClass:"yh-my-red add-pic",attrs:{label:"发生地点",required:"","left-icon":"wap-home-o",disabled:""}}),a._v(" "),t("van-cell-group",[t("van-field",{staticStyle:{width:"calc(100% - 30px)",display:"inline-block"},attrs:{rows:"1",autosize:"",type:"textarea",clearable:""},on:{blur:function(e){a.blur(a.repairData.leakAddress,"leakAddress")}},model:{value:a.repairData.leakAddress,callback:function(e){a.$set(a.repairData,"leakAddress",e)},expression:"repairData.leakAddress"}}),a._v(" "),t("van-icon",{attrs:{name:"location"},on:{click:function(e){a.goMap("repair")}}})],1),a._v(" "),t("van-field",{staticClass:"yh-my-blue add-pic",attrs:{label:"故障设备",required:"","left-icon":"award-o",size:"large",disabled:""}}),a._v(" "),t("van-radio-group",{model:{value:a.repairData.faultEquipmentType,callback:function(e){a.$set(a.repairData,"faultEquipmentType",e)},expression:"repairData.faultEquipmentType"}},a._l(a.equipmentData,function(e,i){return t("van-radio",{key:i,attrs:{name:e.value}},[a._v(a._s(e.name))])})),a._v(" "),t("van-field",{staticClass:"yh-my-red add-pic",attrs:{label:"备注信息","left-icon":"comment-o",size:"large"}}),a._v(" "),t("van-cell-group",{staticClass:"beizhu"},[t("van-field",{attrs:{rows:"1",autosize:"",type:"textarea",maxlength:"100","show-word-limit":"",placeholder:"请输入备注信息",clearable:""},on:{blur:function(e){a.blur(a.repairData.repairRemark,"repairRemark")}},model:{value:a.repairData.repairRemark,callback:function(e){a.$set(a.repairData,"repairRemark",e)},expression:"repairData.repairRemark"}})],1),a._v(" "),t("div",{staticClass:"yh-my-uploader"},[t("van-uploader",{attrs:{multiple:"","max-count":3},model:{value:a.repairFileList,callback:function(e){a.repairFileList=e},expression:"repairFileList"}},[t("div",{staticClass:"uploader-content"},[t("van-icon",{attrs:{name:"/wxcss2/static/img/xiangji.png"}}),a._v(" "),t("div",{staticClass:"uploader-length"},[a._v(a._s(a.repairFileList.length)+"/3")])],1)])],1),a._v(" "),t("van-field",{staticClass:"yh-my-blue",attrs:{"left-icon":"manager-o",label:"联系人",placeholder:"请输入联系人",size:"large"},on:{blur:function(e){a.blur(a.repairData.contact,"contact")}},model:{value:a.repairData.contact,callback:function(e){a.$set(a.repairData,"contact",e)},expression:"repairData.contact"}}),a._v(" "),t("van-field",{staticClass:"yh-my-red",attrs:{"left-icon":"phone-o",label:"联系电话",placeholder:"请输入手机号码",size:"large"},on:{blur:function(e){a.blur(a.repairData.phone,"phone")}},model:{value:a.repairData.phone,callback:function(e){a.$set(a.repairData,"phone",e)},expression:"repairData.phone"}})],1),a._v(" "),t("van-button",{staticClass:"next",attrs:{type:"info"},on:{click:function(e){a.getFtoken(1)}}},[a._v("提   交")])],1),a._v(" "),t("tab-item",{attrs:{title:"进度查询"},nativeOn:{click:function(e){a.tabItemClick(e)}}},[0!==a.historyData.length?t("div",{staticClass:"yh-content",on:{touchmove:function(e){a.touchmove(e)},scroll:function(e){a.scroll(e)}}},a._l(a.historyData,function(e){return t("div",{key:e.id,staticClass:"yh-parent",on:{click:function(t){a.goLeakandrepairsDetail(e)}}},[t("div",{staticClass:"yh-top"},[t("span",[a._v(a._s(e.groupName))]),a._v(" "),t("span",{staticClass:"yh-status"},[a._v(a._s(e.status))])]),a._v(" "),t("div",{staticClass:"yh-top"},[t("span",[a._v("工单单号：")]),a._v(" "),t("span",[a._v(a._s(e.id))])]),a._v(" "),t("div",{staticClass:"yh-middle"},[t("span",[a._v("备注信息：")]),a._v(" "),t("span",[a._v(a._s(e.repairRemark))])]),a._v(" "),t("div",{staticClass:"yh-bottom"},[t("span",[(e.repairOrLeak,t("span",[a._v("提交时间：")])),a._v(" "),t("span",[a._v(a._s(e.repairOrLeakDate))])])]),a._v(" "),t("div",{staticClass:"yh-bottom"},[t("span",[(e.repairOrLeak,t("span",[a._v("地址：")])),a._v(" "),t("span",{staticClass:"address"},[a._v(a._s(e.leakAddress))])])]),a._v(" "),"未受理"==e.status||"已受理"==e.status?t("div",{staticClass:"yh-bottom",staticStyle:{display:"flex"}},[t("van-button",{staticClass:"returnBtn",attrs:{type:"info"},on:{click:function(t){a.reCall(t,e)}}},[a._v("撤   回")])],1):a._e()])})):a._e(),a._v(" "),0==a.historyData.length?t("div",{staticClass:"yh-content yh-nodata"},[t("span",[a._v("您暂无报修报漏信息。")])]):a._e()])],1)],1),a._v(" "),t("van-popup",{style:{height:"40%"},attrs:{position:"bottom"},model:{value:a.relationShow,callback:function(e){a.relationShow=e},expression:"relationShow"}},[t("van-area",{attrs:{"area-list":a.areaList,value:a.areaNum},on:{confirm:a.sure,cancel:a.exit,change:a.onChange}})],1),a._v(" "),t("van-popup",{style:{height:"40%"},attrs:{position:"bottom"},model:{value:a.equipmentShow,callback:function(e){a.equipmentShow=e},expression:"equipmentShow"}},[t("van-picker",{staticClass:"timepicker",attrs:{"show-toolbar":"",title:"故障设备",columns:a.equipmentColumns},on:{cancel:a.onCancelEquipment,confirm:a.onConfirmEquipment}})],1),a._v(" "),t("van-popup",{style:{height:"40%"},attrs:{position:"bottom"},model:{value:a.leakEquipmentShow,callback:function(e){a.leakEquipmentShow=e},expression:"leakEquipmentShow"}},[t("van-picker",{staticClass:"timepicker",attrs:{"show-toolbar":"",title:"报障设备",columns:a.leakEquipmentColumns},on:{cancel:a.onCancelLeakEquipment,confirm:a.onConfirmLeakEquipment}})],1),a._v(" "),t("van-popup",{style:{height:"40%"},attrs:{position:"bottom"},model:{value:a.timeShow,callback:function(e){a.timeShow=e},expression:"timeShow"}},[t("van-datetime-picker",{staticClass:"timepicker",attrs:{formatter:a.formatter,type:"date"},on:{confirm:a.confirmTime,cancel:a.cancelTime},model:{value:a.currDate,callback:function(e){a.currDate=e},expression:"currDate"}})],1),a._v(" "),t("van-popup",{style:{height:"40%"},attrs:{position:"bottom"},model:{value:a.userNumShow,callback:function(e){a.userNumShow=e},expression:"userNumShow"}},[t("van-picker",{staticClass:"timepicker",attrs:{"show-toolbar":"",title:"用户编号",columns:a.userNumColumns},on:{cancel:a.onCancelRelation,confirm:a.onConfirmRelation}})],1)],1):a.repairMapShow?t("myMap",{attrs:{mapNeedData:a.mapNeedData,leakAddress:a.leakAddress}}):a._e()},h=[],f={render:m,staticRenderFns:h},k=f,g=t("VU/8"),v=i,b=g(u,k,!1,v,"data-v-460d5782",null);e.default=b.exports},hadM:function(a,e,t){"use strict";function i(a){t("YmNV")}Object.defineProperty(e,"__esModule",{value:!0});var r=t("rYnR"),o=t("Fd2+"),n={components:{myHeader:r.default},props:["mapNeedData","leakAddress"],data:function(){var a=this;return{title:"报修地点",zoom:16,center:[121.52014,31.198862],searchOption:{city:"深圳市",citylimit:!0},marker:{position:[121.52014,31.198862]},address:"",lng:0,lat:0,events:{click:function(e){var t=e.lnglat,i=t.lng,r=t.lat;a.lng=i,a.lat=r,a.marker.position=[i,r],new AMap.Geocoder({radius:1e3,extensions:"all"}).getAddress([i,r],function(e,t){"complete"===e&&"OK"===t.info&&t&&t.regeocode&&(a.address=t.regeocode.formattedAddress,a.$nextTick())})}},plugin:[{pName:"Geolocation",events:{init:function(e){e.getCurrentPosition(function(e,t){if(t&&t.position){a.lng=t.position.lng,a.lat=t.position.lat,a.center=[a.lng,a.lat],a.marker.position=[a.lng,a.lat];new AMap.Geocoder({radius:1e3,extensions:"all"}).getAddress([a.lng,a.lat],function(e,t){"complete"===e&&"OK"===t.info&&t&&t.regeocode&&(a.address=t.regeocode.formattedAddress,a.$nextTick())}),a.$nextTick()}})}}}]}},mounted:function(){this.initConfigMes(),$(".myMap .search-box .search-box-wrapper input").attr("placeholder","查找地点");$(".myMap .search-box .search-box-wrapper input").before('<img src="../../../static/img/fangdajing.png" alt="" height="22px" style="margin-left:2%">')},methods:{getUserMes:function(){this.searchOption={city:this.mapNeedData.province,citylimit:!0},this.title=this.mapNeedData.province,this.$nextTick()},onSearchResult:function(a){console.log(a);var e=this,t=a[0].lng,i=a[0].lat;this.center=[t,i],this.marker.position=[t,i],new AMap.Geocoder({radius:1e3,extensions:"all"}).getAddress([t,i],function(a,t){"complete"===a&&"OK"===t.info&&t&&t.regeocode&&(e.address=t.regeocode.formattedAddress,e.$nextTick())})},initConfigMes:function(){var a=this;this.title=this.mapNeedData.province;var e={data:{url:window.location.href}};this.$api.fetch({params:e,apiUrl:"/public/wxConfigMes"}).then(function(e){a.wxData=e,a.wx.config({appId:e.appId,timestamp:e.timestamp,nonceStr:e.nonceStr,signature:e.signature,jsApiList:["getLocation"]}),a.wx.ready(function(e){a.wx.getLocation({type:"gcj02",success:function(e){var t=e.latitude,i=e.longitude;e.speed,e.accuracy;a.lng=i,a.lat=t,a.center=[i,t],a.marker.position=[i,t],(new AMap.Geocoder).getAddress([i,t],function(e,t){"complete"===e&&"OK"===t.info&&t&&t.regeocode&&(a.address=t.regeocode.formattedAddress,a.$nextTick())}),a.$nextTick()},fail:function(a){}})})})},onClickLeft:function(){this.backChange(0)},onClickRight:function(){if(""==this.address){if("repair"==this.mapNeedData.content)return void o.d.fail("报障地点不能为空");if("leak"==this.mapNeedData.content)return void o.d.fail("报漏地点不能为空")}this.backChange(1)},backChange:function(a){var e={};0==a?e.address=this.leakAddress:1==a&&(e.address=this.address),this.BUS.$emit("getAddress",e.address,this.mapNeedData.content),this.$parent.leakandrepairsShow=!0,this.$parent.repairMapShow=!1}}},s=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",{staticClass:"myMap"},[t("page-content",[t("van-nav-bar",{attrs:{title:a.title,"left-text":"返回","right-text":"确定","left-arrow":""},on:{"click-left":a.onClickLeft,"click-right":a.onClickRight}}),a._v(" "),t("div",{staticClass:"map_content"},[t("div",{staticClass:"amap-page-container"},[t("el-amap-search-box",{staticClass:"search-box",attrs:{"search-option":a.searchOption,"on-search-result":a.onSearchResult},on:{keyup:function(e){if(!("button"in e)&&a._k(e.keyCode,"enter",13,e.key))return null;a.onSearchResult(e)}}}),a._v(" "),t("el-amap",{staticClass:"amap-demo",attrs:{vid:"amapDemo",plugin:a.plugin,center:a.center,zoom:a.zoom,events:a.events}},[t("el-amap-marker",{attrs:{position:a.marker.position,events:a.marker.events,visible:a.marker.visible,draggable:a.marker.draggable}})],1),a._v(" "),t("van-field",{staticClass:"kron-field",attrs:{label:"报修地址：",rows:"3",autosize:"",type:"textarea",value:a.address,placeholder:"请选择报修地址",readonly:""}})],1)])],1)],1)},l=[],d={render:s,staticRenderFns:l},p=d,c=t("VU/8"),u=i,m=c(n,p,!1,u,"data-v-7fd38e98",null);e.default=m.exports},vPhR:function(a,e,t){e=a.exports=t("FZ+f")(void 0),e.push([a.i,".myMap .el-vue-search-box-container .search-tips[data-v-7fd38e98]{border:none}.myMap .map_content[data-v-7fd38e98]{height:93%;margin:0}.myMap .map_content .amap-page-container[data-v-7fd38e98]{height:86%}.myMap .map_content .amap-page-container .search-box[data-v-7fd38e98]{width:90%;height:46px;line-height:46px;position:absolute;top:55px;left:5%}.myMap .map_content .amap-page-container .kron-field[data-v-7fd38e98]{height:18%}",""])}});
//# sourceMappingURL=10.9e2f7f8d8ac6b7b2f181.js.map